import os
import subprocess
import time
import threading


# -------------------------------------Thread definition----------------------------------------------------------------

class myThread(threading.Thread):  # thread definition updated in python 3.0
    def __init__(self, threadID, threadName, ip):
        threading.Thread.__init__(self)
        self.threadID = threadID
        self.threadName = threadName
        self.ip = ip

    def run(self):
        print("Starting " + self.threadName)
        crack_password(self.threadName, self.ip)
        print("Exiting " + self.threadName)


# ----------------------------------------------------------------------------------------------------------------------

# ---------------------------------------------Methodes------------------------------------------------------------------

def crack_password(threadName, ip):  # scan def for threads to run
    print(threadName + " works")
    os.system("nikto -o " + ip + ".xml -Format xml -Option USERAGENT=Mozilla -h " + ip + " -ssl")

# ----------------------------------------------------------------------------------------------------------------------


approvedstart = False
threads = []
threadnumber = 1

print("Website scanner activated!")
print("Before starting make sure you put the ip in the specific folder!")
print("this scan can take around an hour per ip so hold tight!")
start = input("are you ready? (yes/no)")
start = start.lower()

if start == "yes":
    approvedstart = True

if approvedstart:
    f = open("Resources/websiteScanner/ipToScan")
    f1 = f.readlines()
    for x in f1:
        while threading.activeCount() > 4:  # dont go above 10 threads at the same time
            print("max threads achived, waiting for space")
            time.sleep(10)
        #thread = myThread(1, "Thread-" + str(threadnumber), x)  # creating thread
        #thread.start()
        #threads.append(thread)  # add to pool
        os.system("nikto -o " + x + ".xml -Format xml -Option USERAGENT=Mozilla -h " + x + " -ssl")
        threadnumber += 1
        #test


